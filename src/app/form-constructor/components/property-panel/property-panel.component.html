<div class="property-panel custom-scrollbar">
  <!-- Header -->
  <div class="property-panel-header">
    <h3 class="property-panel-title">Properties</h3>
    @if (hasSelectedComponent()) {
      <div class="property-actions">
        <button
          class="btn btn-sm"
          (click)="copyProperties()"
          title="Copy Properties">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
          </svg>
        </button>
        <button
          class="btn btn-sm"
          (click)="pasteProperties()"
          title="Paste Properties">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
          </svg>
        </button>
        <button
          class="btn btn-sm"
          (click)="resetToDefaults()"
          title="Reset to Defaults">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
          </svg>
        </button>
      </div>
    }
  </div>

  <!-- Content -->
  @if (hasSelectedComponent() && currentForm()) {
    <div class="property-content">
      <!-- Component Info -->
      <div class="component-info">
        <div class="component-name">{{ componentName() }}</div>
        <div class="component-type text-gray-500">
          Selected Component
        </div>
      </div>

      <!-- Property Groups -->
      <form [formGroup]="currentForm()!" class="property-form">
        @for (group of groups(); track group.name) {
          <div class="property-section">
            <button 
              type="button"
              class="property-section-header"
              (click)="toggleGroup(group.name)"
              [class.expanded]="group.expanded">
              <span class="property-section-title">{{ group.label }}</span>
              <svg class="property-section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            
            @if (group.expanded) {
              <div class="property-section-content">
                @for (property of group.properties; track property.name) {
                  <div class="property-field">
                    <!-- Text Input -->
                    @if (property.type === 'text') {
                      <label class="property-label" [for]="property.name">
                        {{ property.label }}
                      </label>
                      <input 
                        [id]="property.name"
                        [formControlName]="property.name"
                        type="text" 
                        class="property-input"
                        [placeholder]="property.defaultValue">
                    }
                    
                    <!-- Number Input -->
                    @if (property.type === 'number') {
                      <label class="property-label" [for]="property.name">
                        {{ property.label }}
                      </label>
                      <input 
                        [id]="property.name"
                        [formControlName]="property.name"
                        type="number" 
                        class="property-input"
                        [placeholder]="property.defaultValue">
                    }
                    
                    <!-- Select Dropdown -->
                    @if (property.type === 'select' && property.options) {
                      <label class="property-label" [for]="property.name">
                        {{ property.label }}
                      </label>
                      <select 
                        [id]="property.name"
                        [formControlName]="property.name"
                        class="property-select">
                        @for (option of property.options; track option.value) {
                          <option [value]="option.value">{{ option.label }}</option>
                        }
                      </select>
                    }
                    
                    <!-- Boolean Checkbox -->
                    @if (property.type === 'boolean') {
                      <div class="property-checkbox-wrapper">
                        <input 
                          [id]="property.name"
                          [formControlName]="property.name"
                          type="checkbox" 
                          class="property-checkbox">
                        <label class="property-checkbox-label" [for]="property.name">
                          {{ property.label }}
                        </label>
                      </div>
                    }
                    
                    <!-- Color Picker -->
                    @if (property.type === 'color') {
                      <label class="property-label" [for]="property.name">
                        {{ property.label }}
                      </label>
                      <div class="property-color-wrapper">
                        <input 
                          [id]="property.name"
                          [formControlName]="property.name"
                          type="color" 
                          class="property-color">
                        <input 
                          [formControlName]="property.name"
                          type="text" 
                          class="property-input property-color-text"
                          placeholder="#000000">
                      </div>
                    }
                  </div>
                }
              </div>
            }
          </div>
        }
      </form>
    </div>
  } @else {
    <!-- No Selection State -->
    <div class="no-selection">
      <div class="no-selection-icon">
        <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"/>
        </svg>
      </div>
      <div class="no-selection-title">No Component Selected</div>
      <div class="no-selection-subtitle">
        Select a component in the editor to edit its properties
      </div>
    </div>
  }
</div>